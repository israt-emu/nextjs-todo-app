generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
}

model User {
  userId   Int     @id @default(autoincrement())
  email    String  @unique
  phone    String
  name     String
  password String
  photo    String?
  address  String?
  todos    Todo[]
  notes    Note[]
}

model Category {
  id      Int            @id @default(autoincrement())
  name    String         @unique
  colorId Int?
  color   Color?         @relation(fields: [colorId], references: [id])
  todos   TodoCategory[]
}

model Color {
  id         Int        @id @default(autoincrement())
  name       String
  hexCode    String
  todos      Todo[]
  notes      Note[]
  categories Category[]
}

model Todo {
  id         Int            @id @default(autoincrement())
  title      String
  reminder   DateTime?
  completed  Boolean        @default(false)
  createdAt  DateTime       @default(now())
  updatedAt  DateTime       @updatedAt
  userId     Int
  colorId    Int?
  user       User           @relation(fields: [userId], references: [userId])
  color      Color?         @relation(fields: [colorId], references: [id])
  categories TodoCategory[]
}

model Note {
  id         Int      @id @default(autoincrement())
  title      String
  coverImg   String?
  coverEmoji String?
  content    String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  userId     Int
  colorId    Int?
  user       User     @relation(fields: [userId], references: [userId])
  color      Color?   @relation(fields: [colorId], references: [id])
}

model TodoCategory {
  todo       Todo     @relation(fields: [todoId], references: [id], onDelete: Cascade)
  category   Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  todoId     Int
  categoryId Int

  @@id([todoId, categoryId])
}
